#!/bin/bash

# Initial blank line
echo

# Options' defaults
error_msg=''
dry_state=''

# Parse options
for arg in $@; do
    if [ "$arg" == '--dry-run' ]; then
        dry_state=$arg
    else
        if [ "$error_msg" != '' ]; then
            echo $error_msg
            echo
        else
            echo 'Invalid usage.'
            echo
        fi

        exit 1
    fi
done

# Run
rsync -rltpxh -e 'ssh -p 706' ${dry_state} --progress --files-from="/etc/backup-to-nas/include.list" --exclude-from="/etc/backup-to-nas/exclude.list" --delete / Fabien@diskstation.home:/volume1/Fabien_Perso/Backup

# Close
echo
exit 0
